{"version":3,"sources":["../../src/Utility/Logger.js"],"names":["Logger","constructor","args","logsPath","getLogsPath","logger","level","format","_format","json","transports","_transports","File","filename","save","state","Promise","resolve","file","JSON","stringify","info","log","report","logsPathBase","getProjectPath"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AACA;;;;AAEA,MAAMA,MAAN,CAAa;AAKTC,EAAAA,WAAW,CAACC,IAAD,EAAa;AACpB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAKC,QAAL,GAAgB,KAAKC,WAAL,EAAhB;AACA,SAAKC,MAAL,GAAc,2BAAa;AACvBC,MAAAA,KAAK,EAAE,MADgB;AAEvBC,MAAAA,MAAM,EAAEC,gBAAQC,IAAR,EAFe;AAGvBC,MAAAA,UAAU,EAAE,CACR,IAAIC,oBAAYC,IAAhB,CAAqB;AAACC,QAAAA,QAAQ,EAAE,gBAAK,KAAKV,QAAV,EAAoB,cAApB;AAAX,OAArB,CADQ;AAHW,KAAb,CAAd;AAOH;;AAEDW,EAAAA,IAAI,CAACC,KAAD,EAA2B;AAC3B,WAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAa;AAC5B,UAAIC,IAAI,GAAG,gBAAK,KAAKf,QAAV,EAAoB,YAApB,CAAX;AACA,6BAAce,IAAd,EAAoBC,IAAI,CAACC,SAAL,CAAeL,KAAf,CAApB;AACAE,MAAAA,OAAO;AACV,KAJM,CAAP;AAKH;;AAEDI,EAAAA,IAAI,CAACN,KAAD,EAAa;AACb,SAAKV,MAAL,CAAYiB,GAAZ,CAAgB,MAAhB,EAAwBH,IAAI,CAACC,SAAL,CAAeL,KAAf,CAAxB;AACH;;AAEDQ,EAAAA,MAAM,CAACR,KAAD,EAAa;AACf,SAAKD,IAAL,CAAUC,KAAV;AACA,SAAKM,IAAL,CAAUN,KAAV;AACH;;AAEDX,EAAAA,WAAW,GAAG;AACV,QAAIoB,YAAY,GAAG,gBAAK,KAAKtB,IAAL,CAAUuB,cAAV,EAAL,EAAiC,MAAjC,CAAnB;;AACA,QAAI,CAAC,oBAAWD,YAAX,CAAL,EAA+B;AAC3B,yBAAUA,YAAV;AACH;;AAED,QAAIrB,QAAQ,GAAG,gBAAK,KAAKD,IAAL,CAAUuB,cAAV,EAAL,EAAiC,MAAjC,EAAyC,cAAzC,CAAf;;AACA,QAAI,CAAC,oBAAWtB,QAAX,CAAL,EAA2B;AACvB,yBAAUA,QAAV;AACH;;AACD,WAAOA,QAAP;AACH;;AA7CQ;;eAiDEH,M","sourcesContent":["// @flow\nimport { createLogger, format as _format, transports as _transports } from 'winston';\nimport Args from '../Model/Args';\nimport { join } from \"path\";\nimport { writeFileSync, existsSync, mkdirSync } from \"fs\";\n\nclass Logger {\n    args: Args;\n    logsPath: string;\n    logger: any;\n\n    constructor(args: Args) {\n        this.args = args;\n        this.logsPath = this.getLogsPath();\n        this.logger = createLogger({\n            level: 'info',\n            format: _format.json(),\n            transports: [\n                new _transports.File({filename: join(this.logsPath, 'last_run.log')})\n            ]\n        });\n    }\n\n    save(state: any): Promise<any> {\n        return new Promise((resolve) => {\n            let file = join(this.logsPath, 'state.json');\n            writeFileSync(file, JSON.stringify(state));\n            resolve();\n        });\n    }\n\n    info(state: any) {\n        this.logger.log('info', JSON.stringify(state));\n    }\n\n    report(state: any) {\n        this.save(state);\n        this.info(state);\n    }\n\n    getLogsPath() {\n        let logsPathBase = join(this.args.getProjectPath(), 'logs');\n        if (!existsSync(logsPathBase)) {\n            mkdirSync(logsPathBase);\n        }\n\n        let logsPath = join(this.args.getProjectPath(), 'logs', 'broken_links');\n        if (!existsSync(logsPath)) {\n            mkdirSync(logsPath);\n        }\n        return logsPath;\n    }\n\n}\n\nexport default Logger;"],"file":"Logger.js"}